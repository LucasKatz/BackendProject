<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Restablecer contraseña</title>
  </head>
  <body>
    <h1>Restablecer contraseña</h1>
    <form>
      <input type="hidden" name="token" value="{{token}}">
      <label for="password">Nueva contraseña:</label>
      <input type="password" name="password" id="password">
      <label for="repeatPassword">Confirmar contraseña:</label>
      <input type="password" name="repeatPassword" id="repeatPassword">
      <button id="restablecer"type="submit">Restablecer contraseña</button>
    </form>
  </body>
</html>

<script>
  document.getElementById('restablecer').addEventListener('click', async (event) => {
    event.preventDefault();
    const token = document.querySelector('input[name="token"]').value;
    const password = document.querySelector('input[name="password"]').value;
    const repeatPassword = document.querySelector('input[name="repeatPassword"]').value;

    const response = await fetch('/reset', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        token,
        password,
        repeatPassword
      })
    });

    const data = await response.json();
    alert("Contraseña cambiada con exito");
    window.location.href = '/login'; // Redireccionar al usuario a la página de inicio de sesión
  });
</script>